package Teacher;

import java.util.List;

import org.openqa.selenium.Alert;
import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;
import org.testng.annotations.Test;

import Common.Gototab;
import Common.LaunchApp;
import Data.ExceptionHndeler;
import Data.Read_Data;

public class GradeAssignment {
	public static void main(String args[])
	{
		System.out.println("GradeAssignment");
		String[][]data=Read_Data.ReadData("Greading.csv");
		int count=0;
		while(!(data[count][0].equals("End")))
		{
			GradeAssignment(data[count]);
			count++;
		}
		
	}
	@Test
	public static void GradeStudent()
	{
		System.out.println("GradeAssignment");
		String[][]data=Read_Data.ReadData("Greading.csv");
		int count=0;
		while(!(data[count][0].equals("End")))
		{
			GradeAssignment(data[count]);
			count++;
		}
		
	}
	public static void GradeAssignment(String[] data)
	{
		int count=2;
		try
		{
		Gototab.execute("Assignments");
		LaunchApp.driver.findElement(By.xpath(".//*[.='"+data[0]+"']")).click();
		LaunchApp.driver.findElement(By.xpath(".//*[.='s4 t4']")).click();
		while(!(data[count].equals("End")))
		{
		int len=0;
		String[] s=data[count].split(":");
		
		List <WebElement> li=LaunchApp.driver.findElements(By.xpath(".//*[@name='txtPoints']"));
		len=li.size();
		for(int i=0;i<len;i++)
		{
			li.get(i).clear();
			li.get(i).sendKeys(s[i]);
			Thread.sleep(1000);
		}
		try{
			LaunchApp.driver.findElement(By.xpath(".//*[.='Complete grading']")).click();
			
			Alert alert = LaunchApp.driver.switchTo().alert();
			alert.accept();
			Thread.sleep(10000);
		}catch(Exception e){ExceptionHndeler.Log(data[count],"GradeAssignment", e);e.printStackTrace();}
		try
		{
		LaunchApp.driver.findElement(By.xpath(".//*[.='Next Student']")).click(); Thread.sleep(1000);}catch(Exception e){ExceptionHndeler.Log(data[count],"GradeAssignment", e);e.printStackTrace();}
		count++;
		}
		}
		catch(Exception e){ExceptionHndeler.Log(data[count],"GradeAssignment", e);}
	}

}
