package Teacher;


import org.openqa.selenium.Alert;
import org.openqa.selenium.By;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.WebElement;

import Tech.PublishSectionLevelReport;
import Common.Gototab;
import Common.LaunchApp;
import Data.ExceptionHndeler;

public class Publish_Section_level_Report {

	public static void main(String[] args) {
		args[0]=(String) "Reports";
		Gototab.main(args);
		try{
		Publish_Section_level_Report ps=new Publish_Section_level_Report();
		ps.Execute();
		}catch (Exception e) {}
	}
	public  void Execute()
	{
		LaunchApp.driver.findElement(By.xpath(".//*[@href='/Report/SectionConceptsReport']")).click();
		try {
			Recompute();
			Thread.sleep(1000);
			ExceptionHndeler.getScreen("SectionLevel"+PublishSectionLevelReport.SectionId);
			LaunchApp.driver.findElement(By.linkText("Publish Outcomes Data")).click();
			 Alert alert = LaunchApp.driver.switchTo().alert();
			 Thread.sleep(10000);
		     alert.accept();
		     Thread.sleep(10000);
		     alert.accept();
		     Thread.sleep(10000);
		} catch (InterruptedException e) {
			ExceptionHndeler.getScreen("SectionLevel"+PublishSectionLevelReport.SectionId);
			Alert alert = LaunchApp.driver.switchTo().alert();
			alert.accept();
		    alert.dismiss();
			ExceptionHndeler.Log("Section level Report","Section Level Report", e);
		}
		
	}
	public static void Recompute()
	{
		
		try {
			WebElement element=LaunchApp.driver.findElement(By.xpath(".//*[@name='lnkCOAssessments']")); 
			ClickEvent(element);
			Thread.sleep(3000);
			 element=LaunchApp.driver.findElement(By.xpath(".//*[@class='uploadAssignmentsClass']")); 
			ClickEvent(element);
			Thread.sleep(20000);
			
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
	}
	public static void ClickEvent(WebElement element){
		JavascriptExecutor jse = (JavascriptExecutor)LaunchApp.driver;
	    jse.executeScript("var evt = document.createEvent('MouseEvents');" + "evt.initMouseEvent('click',true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0,null);" + "arguments[0].dispatchEvent(evt);", element);
		
	}
	

}

